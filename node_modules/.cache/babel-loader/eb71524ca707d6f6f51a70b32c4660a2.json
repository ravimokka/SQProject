{"ast":null,"code":"/*\n * @copyright 2016 Sean Connelly (@voidqk), http://syntheti.cc\n * @license MIT\n * @preserve Project Home: https://github.com/voidqk/polybooljs\n */\nvar BuildLog = require('./lib/build-log');\n\nvar Epsilon = require('./lib/epsilon');\n\nvar Intersecter = require('./lib/intersecter');\n\nvar SegmentChainer = require('./lib/segment-chainer');\n\nvar SegmentSelector = require('./lib/segment-selector');\n\nvar GeoJSON = require('./lib/geojson');\n\nvar buildLog = false;\nvar epsilon = Epsilon();\nvar PolyBool;\nPolyBool = {\n  // getter/setter for buildLog\n  buildLog: function (bl) {\n    if (bl === true) buildLog = BuildLog();else if (bl === false) buildLog = false;\n    return buildLog === false ? false : buildLog.list;\n  },\n  // getter/setter for epsilon\n  epsilon: function (v) {\n    return epsilon.epsilon(v);\n  },\n  // core API\n  segments: function (poly) {\n    var i = Intersecter(true, epsilon, buildLog);\n    poly.regions.forEach(i.addRegion);\n    return {\n      segments: i.calculate(poly.inverted),\n      inverted: poly.inverted\n    };\n  },\n  combine: function (segments1, segments2) {\n    var i3 = Intersecter(false, epsilon, buildLog);\n    return {\n      combined: i3.calculate(segments1.segments, segments1.inverted, segments2.segments, segments2.inverted),\n      inverted1: segments1.inverted,\n      inverted2: segments2.inverted\n    };\n  },\n  selectUnion: function (combined) {\n    return {\n      segments: SegmentSelector.union(combined.combined, buildLog),\n      inverted: combined.inverted1 || combined.inverted2\n    };\n  },\n  selectIntersect: function (combined) {\n    return {\n      segments: SegmentSelector.intersect(combined.combined, buildLog),\n      inverted: combined.inverted1 && combined.inverted2\n    };\n  },\n  selectDifference: function (combined) {\n    return {\n      segments: SegmentSelector.difference(combined.combined, buildLog),\n      inverted: combined.inverted1 && !combined.inverted2\n    };\n  },\n  selectDifferenceRev: function (combined) {\n    return {\n      segments: SegmentSelector.differenceRev(combined.combined, buildLog),\n      inverted: !combined.inverted1 && combined.inverted2\n    };\n  },\n  selectXor: function (combined) {\n    return {\n      segments: SegmentSelector.xor(combined.combined, buildLog),\n      inverted: combined.inverted1 !== combined.inverted2\n    };\n  },\n  polygon: function (segments) {\n    return {\n      regions: SegmentChainer(segments.segments, epsilon, buildLog),\n      inverted: segments.inverted\n    };\n  },\n  // GeoJSON converters\n  polygonFromGeoJSON: function (geojson) {\n    return GeoJSON.toPolygon(PolyBool, geojson);\n  },\n  polygonToGeoJSON: function (poly) {\n    return GeoJSON.fromPolygon(PolyBool, epsilon, poly);\n  },\n  // helper functions for common operations\n  union: function (poly1, poly2) {\n    return operate(poly1, poly2, PolyBool.selectUnion);\n  },\n  intersect: function (poly1, poly2) {\n    return operate(poly1, poly2, PolyBool.selectIntersect);\n  },\n  difference: function (poly1, poly2) {\n    return operate(poly1, poly2, PolyBool.selectDifference);\n  },\n  differenceRev: function (poly1, poly2) {\n    return operate(poly1, poly2, PolyBool.selectDifferenceRev);\n  },\n  xor: function (poly1, poly2) {\n    return operate(poly1, poly2, PolyBool.selectXor);\n  }\n};\n\nfunction operate(poly1, poly2, selector) {\n  var seg1 = PolyBool.segments(poly1);\n  var seg2 = PolyBool.segments(poly2);\n  var comb = PolyBool.combine(seg1, seg2);\n  var seg3 = selector(comb);\n  return PolyBool.polygon(seg3);\n}\n\nif (typeof window === 'object') window.PolyBool = PolyBool;\nmodule.exports = PolyBool;","map":null,"metadata":{},"sourceType":"script"}