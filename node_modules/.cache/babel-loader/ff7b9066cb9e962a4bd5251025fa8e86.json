{"ast":null,"code":"var _jsxFileName = \"/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/src/Personal/Layout/chart_room.js\";\nimport React, { Component, useState, useEffect } from \"react\";\nimport { Layout, Menu, Dropdown, Icon, Button, Avatar, Drawer, Input } from \"antd\";\nimport AppRouter from \"../../router\";\nimport { NotificationTab } from \"../components/Header\";\nimport \"./PageLayout.scss\";\nimport ReactApexChart from 'react-apexcharts';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport $ from 'jquery';\nimport Popper from 'popper.js';\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\nimport { isAbsolute } from \"path\";\nimport * as styles from \"./chat.scss\";\nimport axios from \"axios\";\nimport { Host } from \"../../Host\";\nimport firebase from 'firebase';\nimport SendOutlinedIcon from '@material-ui/icons/SendOutlined';\nimport TextsmsOutlinedIcon from '@material-ui/icons/TextsmsOutlined';\nimport { AccessAlarm, ThreeDRotation } from '@material-ui/icons';\nimport { FirebaseConfig } from \"../../FirebaseConfig\";\nconst stylesIcons = {\n  largeIcon: {\n    width: 500,\n    height: 60\n  }\n};\n\nclass ChartRoom extends Component {\n  constructor(props) {\n    super(props);\n\n    this.selectUser = (username, id) => {\n      this.setState({\n        msg_list: []\n      });\n      this.setState({\n        massage_box: true\n      });\n      this.setState({\n        select_username: username\n      });\n      this.setState({\n        received_id: id\n      });\n      this.setState({\n        sel_u_id: id\n      });\n      this.allMassageList(id);\n      this.readMessage(id);\n    };\n\n    this.handleSendMassage = e => {\n      this.setState({\n        msg_list: []\n      });\n      this.setState({\n        massage: this.refs.msg.value\n      });\n      var today = new Date();\n      var time = today.getHours() + ':' + today.getMinutes() + ':' + today.getSeconds();\n      var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();\n\n      if (this.state.message != '') {\n        var newItem = {\n          user_Id: this.state.user_id,\n          sender_name: this.state.user_Name,\n          receive_name: this.state.select_username,\n          send_Id: this.state.user_id,\n          received_Id: this.state.received_id,\n          message: this.state.message,\n          time: time,\n          msg_Status: false,\n          is_read: false,\n          count: 0,\n          timestamp: firebase.database.ServerValue.TIMESTAMP\n        };\n        this.messageSend.push(newItem);\n        this.setState({\n          message: ''\n        });\n      }\n    };\n\n    this.myFunction = e => {\n      var input, filter, ul, p, a, i, txtValue, li, li1;\n      input = document.getElementById(\"Input\");\n      filter = input.value.toUpperCase();\n      ul = document.getElementById(\"my_search\");\n      li = ul.getElementsByTagName(\"div\");\n\n      for (i = 0; i < li.length; i++) {\n        a = li[i].getElementsByTagName(\"h5\")[0];\n        txtValue = a.textContent || a.innerText;\n\n        if (txtValue.toUpperCase().indexOf(filter) > -1) {\n          li[i].style.display = \"\";\n        } else {\n          li[i].style.display = \"none\";\n        }\n      }\n    };\n\n    this.state = {\n      online: false,\n      massage_box: false,\n      select_username: '',\n      user_list: [],\n      userName: 'Vamsi',\n      user_id: '',\n      sel_u_id: '',\n      send_msg_list: [],\n      received_list: [],\n      send_id: '',\n      received_id: '',\n      text: 'sqd_massages',\n      user_text: 'users',\n      user_status: [],\n      msg: '',\n      message: '',\n      user_Name: '',\n      user_Email: '',\n      massage_List: '',\n      msg_list: [{\n        'massage': 'hi'\n      }],\n      x: 1,\n      u: []\n    };\n    this.messageSend = firebase.database().ref().child('messages/' + this.state.text);\n    this.allMassageList();\n    this.allUserStatus();\n  }\n\n  componentWillMount() {\n    var profile_data = JSON.parse(sessionStorage.getItem(\"session_data\"));\n    this.setState({\n      user_Name: profile_data['username']\n    });\n    this.setState({\n      user_Email: profile_data['email']\n    });\n    this.loadAllUserList();\n    this.massageCount();\n    this.allMassageList(1);\n    this.setState({\n      user_id: profile_data['user_id']\n    });\n  }\n\n  async massageCount() {\n    this.msg = firebase.database().ref().child('messages/' + this.state.text).orderByChild(\"is_read\").equalTo(false).on('value', message => {\n      if (message.val() != null) {\n        //            console.log('vei',Object.values(message.val()))\n        var count = {};\n        var rid = []; //            console.log('values',Object.values(this.state.user_list))\n\n        for (var x = 0; x < Object.keys(this.state.user_list).length; x++) {\n          rid.push(this.state.user_list[x]['id']);\n        } //                console.log(rid)\n\n\n        var rsm_list = Object.values(message.val());\n\n        if (rsm_list != null) {\n          for (var y in rid) {\n            var cnt = 0;\n\n            for (var i = 0; i < Object.keys(rsm_list).length; i++) {\n              if (rsm_list[i]['received_Id'] == this.state.user_id && rsm_list[i]['send_Id'] == rid[y]) {\n                cnt += 1;\n              }\n            }\n\n            var index = this.state.user_list.map(function (i) {\n              return i.id;\n            }).indexOf(rid[y]);\n            this.state.user_list[index]['count'] = cnt; //                this.setState({msg_count:count});\n            //         console.log(this.state.user_list)\n          } //              console.log(this.state.user_list)\n\n\n          this.setState({\n            u: this.state.user_list\n          }); //             this.setState({msg_list:this.state.user_list})\n        } else {\n          this.setState({\n            msg_count: []\n          });\n        }\n      }\n    });\n  }\n\n  async loadAllUserList() {\n    this.setState({\n      user_list: []\n    });\n    var profile_data = JSON.parse(sessionStorage.getItem(\"session_data\"));\n    const promise = await axios.post(Host.loginURL + \"/chat_user_api\", {\n      username: profile_data['username'],\n      email: profile_data['email']\n    });\n    const status = promise.status;\n\n    if (status === 200) {\n      const users_list = promise.data.users;\n      this.setState({\n        user_list: users_list\n      });\n    }\n  }\n\n  handleKeyPress(event) {\n    if (event.key !== 'Enter') return;\n    this.handleSendMassage();\n  }\n\n  handleChange(event) {\n    this.setState({\n      message: event.target.value\n    });\n  }\n\n  async readMessage(id) {\n    firebase.database().ref().child('messages/' + 'sqd_massages').orderByChild(\"received_Id\").equalTo(this.state.user_id).on(\"value\", function (snapshot) {\n      if (snapshot.val() != null) {\n        if (Object.values(snapshot.val()).length >= 1) {\n          snapshot.forEach(function (data) {\n            var record = data.val();\n\n            if (id == record['send_Id']) {\n              var key = data.key;\n              console.log(key);\n              firebase.database().ref().child('messages/' + 'sqd_massages/' + key).update({\n                is_read: \"true\"\n              });\n            }\n          });\n        }\n      } else {}\n    });\n  }\n\n  async allMassageList(id) {\n    const s_id = id;\n    this.msg = firebase.database().ref().child('messages/' + this.state.text).on('value', message => {\n      if (message.val() != null) {\n        var i;\n        var m_list = [];\n        var rsm_list = Object.values(message.val());\n\n        for (i = 0; i < Object.keys(rsm_list).length; i++) {\n          if (this.state.user_id == rsm_list[i]['received_Id'] || this.state.user_id == rsm_list[i]['send_Id']) {\n            var re_data = rsm_list[i];\n            m_list.push(re_data);\n          }\n\n          this.setState({\n            msg_list: m_list\n          });\n        }\n      } else {\n        this.setState({\n          msg_list: []\n        });\n      }\n    });\n  }\n\n  async allUserStatus() {\n    this.msg = this.userStatus = firebase.database().ref().child('messages/' + this.state.user_text).on('value', message => {\n      if (message.val() != null) {\n        var u_list = Object.values(message.val());\n        this.setState({\n          user_status: u_list\n        });\n        var i;\n        var ulist = this.state.user_list;\n\n        for (i = 0; i < Object.keys(ulist).length; i++) {\n          var j;\n\n          for (j = 0; j < Object.keys(u_list).length; j++) {\n            if (ulist[i]['id'] == u_list[j]['user_Id']) {\n              if (u_list[i]['user_status'] == 'online') {\n                ulist[i]['user_status'] = 'online';\n              } else {\n                ulist[i]['user_status'] = 'offline';\n              }\n            } else {}\n          }\n        }\n\n        this.setState({\n          u: ulist\n        });\n      } else {\n        this.setState({\n          user_status: []\n        });\n      }\n    });\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      className: \"messaging\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 296\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"inbox_msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"inbox_people\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 298\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"headind_srch\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"recent_heading\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300\n      },\n      __self: this\n    }, React.createElement(\"h4\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 301\n      },\n      __self: this\n    }, \"Users\")), React.createElement(\"div\", {\n      className: \"srch_bar\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 303\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"stylish-input-group\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      className: \"search-bar\",\n      placeholder: \"Search\",\n      id: \"Input\",\n      onChange: this.myFunction,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    })))), React.createElement(\"div\", {\n      id: \"my_search\",\n      className: \"inbox_chat scroll\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, this.state.u.map((value, index) => React.createElement(\"div\", {\n      className: \"chat_list active_chat\",\n      id: \"myUL\",\n      key: index,\n      onClick: () => this.selectUser(value.username, value.id),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 315\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"chat_people\",\n      value: this.state.select_username,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 316\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: \"https://ptetutorials.com/images/user-profile.png\",\n      alt: \"sunil\",\n      className: \"chat_img\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, value.user_status == 'online' ? React.createElement(\"div\", {\n      className: \"chat_ib\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 321\n      },\n      __self: this\n    }, value.count !== 0 ? React.createElement(\"span\", {\n      className: \"notifications\",\n      style: {\n        float: 'right',\n        backgroundColor: '#1890ff'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 322\n      },\n      __self: this\n    }, value.count) : null, React.createElement(\"h5\", {\n      value: value.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 324\n      },\n      __self: this\n    }, value.username, \" \", value.id, React.createElement(\"span\", {\n      className: \"online\",\n      style: {\n        float: 'left',\n        marginLeft: '-19px'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 325\n      },\n      __self: this\n    })), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 327\n      },\n      __self: this\n    }, \"new user for sq dashboard\")) : React.createElement(\"div\", {\n      className: \"chat_ib\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 330\n      },\n      __self: this\n    }, value.count !== 0 ? React.createElement(\"span\", {\n      className: \"notifications\",\n      style: {\n        float: 'right',\n        backgroundColor: '#1890ff'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 331\n      },\n      __self: this\n    }, value.count) : null, React.createElement(\"h5\", {\n      value: value.id,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 333\n      },\n      __self: this\n    }, value.username, \" \", value.id, React.createElement(\"span\", {\n      className: \"offline\",\n      style: {\n        float: 'left',\n        marginLeft: '-19px',\n        backgroundColor: '#faad14'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 334\n      },\n      __self: this\n    })), React.createElement(\"p\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 337\n      },\n      __self: this\n    }, \"new user for sq dashboard\")))))))), React.createElement(\"div\", {\n      className: \"mesgs\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 351\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"alert alert-success  select_user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 352\n      },\n      __self: this\n    }, React.createElement(\"strong\", {\n      style: {\n        marginLeft: \"19px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 353\n      },\n      __self: this\n    }, this.state.select_username), React.createElement(\"img\", {\n      src: \"https://ptetutorials.com/images/user-profile.png\",\n      alt: \"sunil\",\n      className: \"hear_user\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 354\n      },\n      __self: this\n    })), this.state.massage_box == true ? React.createElement(\"div\", {\n      className: \"msg_history\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 358\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"incoming_msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 359\n      },\n      __self: this\n    }, this.state.msg_list.map((value, index) => React.createElement(\"div\", {\n      className: \"received_msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 361\n      },\n      __self: this\n    }, this.state.sel_u_id == value.send_Id ? React.createElement(\"div\", {\n      className: \"received_withd_msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 363\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 364\n      },\n      __self: this\n    }, value.message, \" \"), React.createElement(\"span\", {\n      className: \"time_date\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 365\n      },\n      __self: this\n    }, value.sender_name, \" \", value.time)) : null, this.state.sel_u_id == value.received_Id ? React.createElement(\"div\", {\n      className: \"outgoing_msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 369\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"sent_msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 370\n      },\n      __self: this\n    }, React.createElement(\"p\", {\n      key: index,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 371\n      },\n      __self: this\n    }, value.message, \" \"), React.createElement(\"span\", {\n      className: \"time_date\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 372\n      },\n      __self: this\n    }, value.sender_name, \"   \", value.time))) : null)))) : React.createElement(\"div\", {\n      style: {\n        marginTop: '132px',\n        color: '#bfd0d6'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 380\n      },\n      __self: this\n    }, React.createElement(TextsmsOutlinedIcon, {\n      style: {\n        fontSize: '100px',\n        marginLeft: '144px',\n        color: '#bfd0d6'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 381\n      },\n      __self: this\n    }), React.createElement(\"h2\", {\n      className: \"msg_history\",\n      style: {\n        color: '#bfd0d6'\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 382\n      },\n      __self: this\n    }, \" Welcome to chat \")), React.createElement(\"div\", {\n      className: \"type_msg\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 386\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"input_msg_write\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 387\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"text\",\n      ref: \"msg\",\n      className: \"write_msg\",\n      placeholder: \"Type a message\",\n      value: this.state.message,\n      onKeyPress: this.handleKeyPress.bind(this),\n      onChange: this.handleChange.bind(this),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 388\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      className: \"msg_send_btn\",\n      type: \"button\",\n      onClick: this.handleSendMassage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 392\n      },\n      __self: this\n    }, React.createElement(SendOutlinedIcon, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 393\n      },\n      __self: this\n    })))))));\n  }\n\n}\n\nexport default ChartRoom;","map":{"version":3,"sources":["/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/src/Personal/Layout/chart_room.js"],"names":["React","Component","useState","useEffect","Layout","Menu","Dropdown","Icon","Button","Avatar","Drawer","Input","AppRouter","NotificationTab","ReactApexChart","$","Popper","isAbsolute","styles","axios","Host","firebase","SendOutlinedIcon","TextsmsOutlinedIcon","AccessAlarm","ThreeDRotation","FirebaseConfig","stylesIcons","largeIcon","width","height","ChartRoom","constructor","props","selectUser","username","id","setState","msg_list","massage_box","select_username","received_id","sel_u_id","allMassageList","readMessage","handleSendMassage","e","massage","refs","msg","value","today","Date","time","getHours","getMinutes","getSeconds","date","getFullYear","getMonth","getDate","state","message","newItem","user_Id","user_id","sender_name","user_Name","receive_name","send_Id","received_Id","msg_Status","is_read","count","timestamp","database","ServerValue","TIMESTAMP","messageSend","push","myFunction","input","filter","ul","p","a","i","txtValue","li","li1","document","getElementById","toUpperCase","getElementsByTagName","length","textContent","innerText","indexOf","style","display","online","user_list","userName","send_msg_list","received_list","send_id","text","user_text","user_status","user_Email","massage_List","x","u","ref","child","allUserStatus","componentWillMount","profile_data","JSON","parse","sessionStorage","getItem","loadAllUserList","massageCount","orderByChild","equalTo","on","val","rid","Object","keys","rsm_list","values","y","cnt","index","map","msg_count","promise","post","loginURL","email","status","users_list","data","users","handleKeyPress","event","key","handleChange","target","snapshot","forEach","record","console","log","update","s_id","m_list","re_data","userStatus","u_list","ulist","j","render","float","backgroundColor","marginLeft","marginTop","color","fontSize","bind"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect }  from \"react\";\nimport { Layout, Menu, Dropdown, Icon, Button, Avatar, Drawer, Input } from \"antd\";\nimport AppRouter from \"../../router\";\nimport { NotificationTab } from \"../components/Header\";\nimport \"./PageLayout.scss\";\nimport ReactApexChart from 'react-apexcharts'\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport $ from 'jquery';\nimport Popper from 'popper.js';\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\nimport { isAbsolute } from \"path\";\nimport * as styles  from \"./chat.scss\"\nimport axios from \"axios\";\nimport { Host } from  \"../../Host\";\nimport firebase from 'firebase';\nimport SendOutlinedIcon from '@material-ui/icons/SendOutlined';\nimport TextsmsOutlinedIcon from '@material-ui/icons/TextsmsOutlined';\n\nimport { AccessAlarm, ThreeDRotation } from '@material-ui/icons';\nimport { FirebaseConfig } from  \"../../FirebaseConfig\";\n\n\nconst stylesIcons = {\n\n  largeIcon: {\n    width: 500,\n    height: 60,\n  },\n\n};\n\n\n\nclass ChartRoom extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n        online:false,\n        massage_box:false,\n        select_username:'',\n        user_list:[],\n        userName:'Vamsi',\n        user_id:'',\n        sel_u_id:'',\n        send_msg_list:[],\n        received_list:[],\n        send_id:'',\n        received_id:'',\n        text:'sqd_massages',\n        user_text:'users',\n        user_status:[],\n        msg:'',\n        message:'',\n        user_Name:'',\n        user_Email:'',\n        massage_List:'',\n        msg_list:[{'massage':'hi'}],\n        x:1,\n        u:[],\n    }\n    this.messageSend = firebase.database().ref().child('messages/' + this.state.text);\n    this.allMassageList();\n\n    this.allUserStatus();\n  }\n\ncomponentWillMount() {\n    var profile_data = JSON.parse(sessionStorage.getItem(\"session_data\"));\n    this.setState({user_Name:profile_data['username']});\n    this.setState({user_Email:profile_data['email']});\n    this.loadAllUserList()\n    this.massageCount()\n    this.allMassageList(1);\n    this.setState({user_id:profile_data['user_id']});\n}\n\n\nasync massageCount(){\n       this.msg = firebase.database().ref().child('messages/' + this.state.text)\n       .orderByChild(\"is_read\").equalTo(false).on('value', message => {\n       if ( message.val() != null){\n//            console.log('vei',Object.values(message.val()))\n            var count = {};\n            var rid = [];\n//            console.log('values',Object.values(this.state.user_list))\n            for(var x=0; x<Object.keys(this.state.user_list).length; x++){\n                rid.push(this.state.user_list[x]['id'])\n            }\n//                console.log(rid)\n            var rsm_list = Object.values(message.val());\n            if(rsm_list!=null){\n                for(var y in rid){\n                    var cnt = 0;\n\n              for (var i = 0; i < Object.keys(rsm_list).length; i++) {\n                if(rsm_list[i]['received_Id'] == this.state.user_id && rsm_list[i]['send_Id'] == rid[y]){\n                      cnt+=1\n                } }\n                var index = this.state.user_list.map(function (i) { return i.id; }).indexOf(rid[y]);\n                this.state.user_list[index]['count']=cnt\n//                this.setState({msg_count:count});\n     //         console.log(this.state.user_list)\n              }\n\n//              console.log(this.state.user_list)\n              this.setState({u:this.state.user_list})\n//             this.setState({msg_list:this.state.user_list})\n              }\n            else{\n                this.setState({ msg_count:[]});\n            }\n\n       }\n       });\n\n\n}\n\nasync loadAllUserList()\n  {\n    this.setState({user_list:[]});\n    var profile_data = JSON.parse(sessionStorage.getItem(\"session_data\"));\n    const promise = await axios.post(Host.loginURL +\"/chat_user_api\", {username:profile_data['username'],\n                                                                    email:profile_data['email']});\n    const status = promise.status;\n    if(status===200)\n    {\n      const users_list= promise.data.users;\n      this.setState({user_list:users_list});\n    }\n  }\n\n\nselectUser = (username, id) => {\n    this.setState({msg_list:[]});\n    this.setState({massage_box:true});\n    this.setState({select_username:username});\n    this.setState({received_id:id});\n    this.setState({sel_u_id:id});\n    this.allMassageList(id);\n    this.readMessage(id)\n\n\n  };\n\n\n  handleSendMassage = (e) => {\n     this.setState({msg_list:[]});\n     this.setState({massage:this.refs.msg.value})\n      var today = new Date();\n      var time = today.getHours() + ':' + today.getMinutes() + ':' + today.getSeconds();\n      var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();\n      if(this.state.message != ''){\n        var newItem = {\n        user_Id:this.state.user_id,\n        sender_name:this.state.user_Name,\n        receive_name:this.state.select_username,\n        send_Id:this.state.user_id,\n        received_Id:this.state.received_id,\n        message:this.state.message,\n        time:time,\n        msg_Status:false,\n        is_read:false,\n        count:0,\n        timestamp : firebase.database.ServerValue.TIMESTAMP\n      }\n      this.messageSend.push(newItem);\n      this.setState({ message: '' });\n\n      }\n\n  }\n\n  handleKeyPress(event) {\n    if (event.key !== 'Enter') return;\n    this.handleSendMassage();\n  }\n\n  handleChange(event) {\n    this.setState({message: event.target.value});\n  }\n\n\nasync readMessage(id) {\n  firebase.database().ref().child('messages/' + 'sqd_massages').orderByChild(\"received_Id\").equalTo(this.state.user_id)\n      .on(\"value\", function(snapshot) {\n          if (snapshot.val() != null){\n              if(Object.values(snapshot.val()).length >= 1){\n                snapshot.forEach(function(data) {\n                var record = data.val();\n                if( id == record['send_Id']){\n                    var key = data.key;\n                    console.log(key)\n                     firebase.database().ref().child('messages/' + 'sqd_massages/'+ key).update({ is_read: \"true\"});\n                      }\n\n                });\n              }\n          }\n         else{\n\n         }\n    });\n}\n\n\n\n\n\nasync allMassageList(id){\n       const s_id = id;\n       this.msg = firebase.database().ref().child('messages/' + this.state.text).on('value', message => {\n            if ( message.val() != null){\n              var i;\n              var m_list = []\n              var rsm_list = Object.values(message.val());\n              for (i = 0; i < Object.keys(rsm_list).length; i++) {\n                if((this.state.user_id == rsm_list[i]['received_Id']) || (this.state.user_id == rsm_list[i]['send_Id'])){\n                      var re_data = rsm_list[i]\n                      m_list.push(re_data)\n                }\n               this.setState({msg_list:m_list});\n\n              }\n            }\n            else{\n                this.setState({ msg_list:[]});\n            }\n\n       });\n\n}\n\n\nasync allUserStatus(){\n\n       this.msg = this.userStatus = firebase.database().ref().child('messages/' + this.state.user_text)\n       .on('value', message => {\n            if ( message.val() != null){\n              var u_list = Object.values(message.val());\n              this.setState({user_status:u_list})\n\n              var i;\n              var ulist = this.state.user_list;\n                for (i = 0; i < Object.keys(ulist).length; i++) {\n                 var j;\n                 for (j = 0; j< Object.keys(u_list).length; j++) {\n                     if(ulist[i]['id'] == u_list[j]['user_Id']){\n                        if(u_list[i]['user_status'] == 'online'){\n                           ulist[i]['user_status'] = 'online';\n                        }\n                        else{\n                          ulist[i]['user_status'] = 'offline';\n                        }\n\n                     }\n                     else{\n                     }\n                 }\n              }\n           this.setState({u:ulist})\n\n\n            }\n            else{\n                this.setState({ user_status:[]});\n            }\n       });\n}\n\n\n myFunction = (e) =>{\n    var input, filter, ul, p, a, i, txtValue, li, li1;\n    input = document.getElementById(\"Input\");\n    filter = input.value.toUpperCase();\n    ul = document.getElementById(\"my_search\");\n    li = ul.getElementsByTagName(\"div\");\n    for (i = 0; i < li.length; i++) {\n        a = li[i].getElementsByTagName(\"h5\")[0];\n        txtValue = a.textContent || a.innerText;\n        if (txtValue.toUpperCase().indexOf(filter) > -1) {\n            li[i].style.display = \"\";\n        } else {\n            li[i].style.display = \"none\";\n        }\n    }\n}\n\n\n\n\n  render() {\n\n\n    return (\n    <div className=\"messaging\">\n      <div className=\"inbox_msg\">\n        <div className=\"inbox_people\">\n              <div className=\"headind_srch\">\n                    <div className=\"recent_heading\">\n                      <h4>Users</h4>\n                    </div>\n                    <div className=\"srch_bar\">\n                      <div className=\"stylish-input-group\">\n                        <input type=\"text\" className=\"search-bar\"  placeholder=\"Search\" id = \"Input\"\n                         onChange={this.myFunction}/ >\n                        </div>\n                    </div>\n              </div>\n\n\n          <div id=\"my_search\"  className=\"inbox_chat scroll\">\n              {this.state.u.map((value, index) =>\n\n                <div  className=\"chat_list active_chat\" id=\"myUL\"  key={index} onClick={()=>this.selectUser(value.username, value.id)}>\n                  <div className=\"chat_people\" value={this.state.select_username}>\n                        <img src=\"https://ptetutorials.com/images/user-profile.png\" alt=\"sunil\" className=\"chat_img\" />\n\n                         <div>\n                             {value.user_status == 'online'?\n                                 <div className=\"chat_ib\">\n                                  {value.count!==0 ?<span className=\"notifications\" style={{float:'right',backgroundColor:'#1890ff'}}>\n                                    {value.count}</span>:null}\n                                  <h5 value={value.id} >{value.username} {value.id}\n                                   <span className=\"online\" style={{float:'left', marginLeft: '-19px'}}></span>\n                                   </h5>\n                                  <p>new user for sq dashboard</p>\n                                </div>:\n\n                                <div className=\"chat_ib\">\n                                   {value.count!==0 ?<span className=\"notifications\" style={{float:'right',backgroundColor:'#1890ff'}}>\n                                    {value.count}</span>:null}\n                                  <h5 value={value.id}>{value.username} {value.id}\n                                   <span className=\"offline\" style={{float:'left', marginLeft:'-19px',backgroundColor:'#faad14'}}></span>\n                                   </h5>\n\n                                  <p>new user for sq dashboard</p>\n                                </div>\n                             }\n                       </div>\n\n                  </div>\n\n                </div>\n                )}\n            </div>\n\t  </div>\n\n\n\n        <div className=\"mesgs\">\n        <div className=\"alert alert-success  select_user\">\n          <strong style={{marginLeft:\"19px\"}}>{this.state.select_username}</strong >\n         <img src=\"https://ptetutorials.com/images/user-profile.png\" alt=\"sunil\" className=\"hear_user\" />\n          </div>\n\n        {this.state.massage_box == true?\n          <div className=\"msg_history\">\n                  <div className=\"incoming_msg\">\n                         { this.state.msg_list.map((value, index) =>\n                              <div className=\"received_msg\">\n                              {this.state.sel_u_id == value.send_Id?\n                                <div className=\"received_withd_msg\">\n                                    <p key={index}>{value.message} </p>\n                                  <span className=\"time_date\">{value.sender_name} {value.time}</span>\n                                  </div>:null\n                                  }\n                                  {this.state.sel_u_id == value.received_Id?\n                                  <div className=\"outgoing_msg\">\n                                        <div className=\"sent_msg\">\n                                        <p key={index}>{value.message} </p>\n                                        <span className=\"time_date\">{value.sender_name}   {value.time}</span>\n                                        </div>\n                                  </div>:null\n                               }\n                              </div>\n                          )}\n                        </div>\n\n            </div>: <div style={{marginTop:'132px', color:'#bfd0d6'}}>\n                       <TextsmsOutlinedIcon style={{fontSize:'100px', marginLeft:'144px',color:'#bfd0d6'}}/>\n                       <h2 className=\"msg_history\" style={{color:'#bfd0d6'}}> Welcome to chat </h2>\n                     </div>\n          }\n\n          <div className=\"type_msg\">\n            <div className=\"input_msg_write\">\n              <input type=\"text\"  ref='msg' className=\"write_msg\" placeholder=\"Type a message\"\n                                              value={this.state.message}\n                                              onKeyPress={this.handleKeyPress.bind(this)}\n                                              onChange={this.handleChange.bind(this)}/>\n                  <button className=\"msg_send_btn\" type=\"button\" onClick={this.handleSendMassage}>\n                   <SendOutlinedIcon />\n                   </button>\n            </div>\n          </div>\n\n        </div>\n  </div>\n</div>\n\n    );\n  }\n}\n\nexport default ChartRoom;\n"]},"metadata":{},"sourceType":"module"}