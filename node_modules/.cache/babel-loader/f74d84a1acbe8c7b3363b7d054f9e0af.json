{"ast":null,"code":"/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nexports.init2dArray = function (rowLength, colLength) {\n  var array = new Array(rowLength);\n\n  for (var i = 0; i < rowLength; i++) array[i] = new Array(colLength);\n\n  return array;\n};\n/**\n * transpose a (possibly ragged) 2d array z. inspired by\n * http://stackoverflow.com/questions/17428587/\n * transposing-a-2d-array-in-javascript\n */\n\n\nexports.transposeRagged = function (z) {\n  var maxlen = 0;\n  var zlen = z.length;\n  var i, j; // Maximum row length:\n\n  for (i = 0; i < zlen; i++) maxlen = Math.max(maxlen, z[i].length);\n\n  var t = new Array(maxlen);\n\n  for (i = 0; i < maxlen; i++) {\n    t[i] = new Array(zlen);\n\n    for (j = 0; j < zlen; j++) t[i][j] = z[j][i];\n  }\n\n  return t;\n}; // our own dot function so that we don't need to include numeric\n\n\nexports.dot = function (x, y) {\n  if (!(x.length && y.length) || x.length !== y.length) return null;\n  var len = x.length;\n  var out;\n  var i;\n\n  if (x[0].length) {\n    // mat-vec or mat-mat\n    out = new Array(len);\n\n    for (i = 0; i < len; i++) out[i] = exports.dot(x[i], y);\n  } else if (y[0].length) {\n    // vec-mat\n    var yTranspose = exports.transposeRagged(y);\n    out = new Array(yTranspose.length);\n\n    for (i = 0; i < yTranspose.length; i++) out[i] = exports.dot(x, yTranspose[i]);\n  } else {\n    // vec-vec\n    out = 0;\n\n    for (i = 0; i < len; i++) out += x[i] * y[i];\n  }\n\n  return out;\n}; // translate by (x,y)\n\n\nexports.translationMatrix = function (x, y) {\n  return [[1, 0, x], [0, 1, y], [0, 0, 1]];\n}; // rotate by alpha around (0,0)\n\n\nexports.rotationMatrix = function (alpha) {\n  var a = alpha * Math.PI / 180;\n  return [[Math.cos(a), -Math.sin(a), 0], [Math.sin(a), Math.cos(a), 0], [0, 0, 1]];\n}; // rotate by alpha around (x,y)\n\n\nexports.rotationXYMatrix = function (a, x, y) {\n  return exports.dot(exports.dot(exports.translationMatrix(x, y), exports.rotationMatrix(a)), exports.translationMatrix(-x, -y));\n}; // applies a 2D transformation matrix to either x and y params or an [x,y] array\n\n\nexports.apply2DTransform = function (transform) {\n  return function () {\n    var args = arguments;\n\n    if (args.length === 3) {\n      args = args[0];\n    } // from map\n\n\n    var xy = arguments.length === 1 ? args[0] : [args[0], args[1]];\n    return exports.dot(transform, [xy[0], xy[1], 1]).slice(0, 2);\n  };\n}; // applies a 2D transformation matrix to an [x1,y1,x2,y2] array (to transform a segment)\n\n\nexports.apply2DTransform2 = function (transform) {\n  var at = exports.apply2DTransform(transform);\n  return function (xys) {\n    return at(xys.slice(0, 2)).concat(at(xys.slice(2, 4)));\n  };\n};","map":null,"metadata":{},"sourceType":"script"}