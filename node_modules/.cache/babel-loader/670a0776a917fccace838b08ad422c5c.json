{"ast":null,"code":"import _regeneratorRuntime from\"/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _classCallCheck from\"/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React,{Component,useState,useEffect}from\"react\";import{Layout,Menu,Dropdown,Icon,Button,Avatar,Drawer,Input}from\"antd\";import AppRouter from\"../../router\";import{NotificationTab}from\"../components/Header\";import\"./PageLayout.scss\";import ReactApexChart from'react-apexcharts';import'bootstrap/dist/css/bootstrap.min.css';import $ from'jquery';import Popper from'popper.js';import'bootstrap/dist/js/bootstrap.bundle.min';import{isAbsolute}from\"path\";import*as styles from\"./chat.scss\";import axios from\"axios\";import{Host}from\"../../Host\";import firebase from'firebase';import SendOutlinedIcon from'@material-ui/icons/SendOutlined';import ChatIcon from'@material-ui/icons/Chat';import{AccessAlarm,ThreeDRotation}from'@material-ui/icons';import{FirebaseConfig}from\"../../FirebaseConfig\";var stylesIcons={largeIcon:{width:500,height:60}};var ChartRoom=/*#__PURE__*/function(_Component){_inherits(ChartRoom,_Component);function ChartRoom(props){var _this;_classCallCheck(this,ChartRoom);_this=_possibleConstructorReturn(this,_getPrototypeOf(ChartRoom).call(this,props));_this.selectUser=function(username,id){_this.setState({msg_list:[]});_this.setState({massage_box:true});_this.setState({select_username:username});_this.setState({received_id:id});_this.setState({sel_u_id:id});_this.allMassageList(id);_this.readMessage(id);};_this.handleSendMassage=function(e){_this.setState({msg_list:[]});_this.setState({massage:_this.refs.msg.value});var today=new Date();var time=today.getHours()+':'+today.getMinutes()+':'+today.getSeconds();var date=today.getFullYear()+'-'+(today.getMonth()+1)+'-'+today.getDate();if(_this.state.message!=''){var newItem={user_Id:_this.state.user_id,sender_name:_this.state.user_Name,receive_name:_this.state.select_username,send_Id:_this.state.user_id,received_Id:_this.state.received_id,message:_this.state.message,time:time,msg_Status:false,is_read:false,count:0,timestamp:firebase.database.ServerValue.TIMESTAMP};_this.messageSend.push(newItem);_this.setState({message:''});}};_this.myFunction=function(e){var input,filter,ul,p,a,i,txtValue,li,li1;input=document.getElementById(\"Input\");filter=input.value.toUpperCase();ul=document.getElementById(\"my_search\");li=ul.getElementsByTagName(\"div\");for(i=0;i<li.length;i++){a=li[i].getElementsByTagName(\"h5\")[0];txtValue=a.textContent||a.innerText;if(txtValue.toUpperCase().indexOf(filter)>-1){li[i].style.display=\"\";}else{li[i].style.display=\"none\";}}};_this.state={online:false,massage_box:false,select_username:'',user_list:[],userName:'Vamsi',user_id:'',sel_u_id:'',send_msg_list:[],received_list:[],send_id:'',received_id:'',text:'sqd_massages',user_text:'users',user_status:[],msg:'',message:'',user_Name:'',user_Email:'',massage_List:'',msg_list:[{'massage':'hi'}],x:1,u:[]};_this.messageSend=firebase.database().ref().child('messages/'+_this.state.text);_this.allMassageList();_this.allUserStatus();return _this;}_createClass(ChartRoom,[{key:\"componentWillMount\",value:function componentWillMount(){var profile_data=JSON.parse(sessionStorage.getItem(\"session_data\"));this.setState({user_Name:profile_data['username']});this.setState({user_Email:profile_data['email']});this.loadAllUserList();this.massageCount();this.allMassageList(1);this.setState({user_id:profile_data['user_id']});}},{key:\"massageCount\",value:function massageCount(){var _this2=this;return _regeneratorRuntime.async(function massageCount$(_context){while(1){switch(_context.prev=_context.next){case 0:this.msg=firebase.database().ref().child('messages/'+this.state.text).orderByChild(\"is_read\").equalTo(false).on('value',function(message){if(message.val()!=null){//            console.log('vei',Object.values(message.val()))\nvar count={};var rid=[];//            console.log('values',Object.values(this.state.user_list))\nfor(var x=0;x<Object.keys(_this2.state.user_list).length;x++){rid.push(_this2.state.user_list[x]['id']);}//                console.log(rid)\nvar rsm_list=Object.values(message.val());if(rsm_list!=null){for(var y in rid){var cnt=0;for(var i=0;i<Object.keys(rsm_list).length;i++){if(rsm_list[i]['received_Id']==_this2.state.user_id&&rsm_list[i]['send_Id']==rid[y]){cnt+=1;}}var index=_this2.state.user_list.map(function(i){return i.id;}).indexOf(rid[y]);_this2.state.user_list[index]['count']=cnt;//                this.setState({msg_count:count});\n//         console.log(this.state.user_list)\n}console.log(_this2.state.user_list);_this2.setState({u:_this2.state.user_list});//             this.setState({msg_list:this.state.user_list})\n}else{_this2.setState({msg_count:[]});}}else{var i;var u_l=_this2.state.user_list;for(var i=0;i<Object.keys(u_l).length;i++){u_l[i]['count']=0;_this2.setState({u:u_l});}}});case 1:case\"end\":return _context.stop();}}},null,this);}},{key:\"loadAllUserList\",value:function loadAllUserList(){var profile_data,promise,status,users_list;return _regeneratorRuntime.async(function loadAllUserList$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:this.setState({user_list:[]});profile_data=JSON.parse(sessionStorage.getItem(\"session_data\"));_context2.next=4;return _regeneratorRuntime.awrap(axios.post(Host.loginURL+\"/chat_user_api\",{username:profile_data['username'],user_id:profile_data['user_id'],email:profile_data['email']}));case 4:promise=_context2.sent;status=promise.status;if(status===200){users_list=promise.data.users;this.setState({user_list:users_list});}case 7:case\"end\":return _context2.stop();}}},null,this);}},{key:\"handleKeyPress\",value:function handleKeyPress(event){if(event.key!=='Enter')return;this.handleSendMassage();}},{key:\"handleChange\",value:function handleChange(event){this.setState({message:event.target.value});}},{key:\"readMessage\",value:function readMessage(id){return _regeneratorRuntime.async(function readMessage$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:firebase.database().ref().child('messages/'+'sqd_massages').orderByChild(\"received_Id\").equalTo(this.state.user_id).on(\"value\",function(snapshot){if(snapshot.val()!=null){if(Object.values(snapshot.val()).length>=1){snapshot.forEach(function(data){var record=data.val();if(id==record['send_Id']){var key=data.key;console.log(key);firebase.database().ref().child('messages/'+'sqd_massages/'+key).update({is_read:\"true\"});}});}}else{}});case 1:case\"end\":return _context3.stop();}}},null,this);}},{key:\"allMassageList\",value:function allMassageList(id){var _this3=this;var s_id;return _regeneratorRuntime.async(function allMassageList$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:s_id=id;this.msg=firebase.database().ref().child('messages/'+this.state.text).on('value',function(message){if(message.val()!=null){var i;var m_list=[];var rsm_list=Object.values(message.val());for(i=0;i<Object.keys(rsm_list).length;i++){if(_this3.state.user_id==rsm_list[i]['received_Id']||_this3.state.user_id==rsm_list[i]['send_Id']){var re_data=rsm_list[i];m_list.push(re_data);}_this3.setState({msg_list:m_list});}}else{_this3.setState({msg_list:[]});}});case 2:case\"end\":return _context4.stop();}}},null,this);}},{key:\"allUserStatus\",value:function allUserStatus(){var _this4=this;return _regeneratorRuntime.async(function allUserStatus$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:this.msg=this.userStatus=firebase.database().ref().child('messages/'+this.state.user_text).on('value',function(message){if(message.val()!=null){var u_list=Object.values(message.val());_this4.setState({user_status:u_list});var i;var ulist=_this4.state.user_list;for(i=0;i<Object.keys(ulist).length;i++){var j;for(j=0;j<Object.keys(u_list).length;j++){if(ulist[i]['id']==u_list[j]['user_Id']){if(u_list[i]['user_status']=='online'){ulist[i]['user_status']='online';}else{ulist[i]['user_status']='offline';}}else{}}}_this4.setState({u:ulist});}else{_this4.setState({user_status:[]});}});case 1:case\"end\":return _context5.stop();}}},null,this);}},{key:\"render\",value:function render(){var _this5=this;return React.createElement(\"div\",{className:\"messaging\"},React.createElement(\"div\",{className:\"inbox_msg\"},React.createElement(\"div\",{className:\"inbox_people\"},React.createElement(\"div\",{className:\"headind_srch\"},React.createElement(\"div\",{className:\"recent_heading\"},React.createElement(\"h4\",null,React.createElement(Icon,{type:\"group\"}),\"Users\")),React.createElement(\"div\",{className:\"srch_bar\"},React.createElement(\"div\",{className:\"stylish-input-group\"},React.createElement(\"input\",{type:\"text\",className:\"search-bar\",placeholder:\"Search\",id:\"Input\",onChange:this.myFunction})))),React.createElement(\"div\",{id:\"my_search\",className:\"inbox_chat scroll\"},this.state.u.map(function(value,index){return React.createElement(\"div\",{className:\"chat_list active_chat\",id:\"myUL\",key:index,onClick:function onClick(){return _this5.selectUser(value.username,value.id);}},React.createElement(\"div\",{className:\"chat_people\",value:_this5.state.select_username},React.createElement(\"img\",{src:\"https://ptetutorials.com/images/user-profile.png\",alt:\"sunil\",className:\"chat_img\"}),React.createElement(\"div\",null,value.user_status=='online'?React.createElement(\"div\",{className:\"chat_ib\"},value.count!=0?React.createElement(\"span\",{className:\"notifications\",style:{float:'right',backgroundColor:'#1890ff'}},value.count):null,React.createElement(\"h5\",{value:value.id},value.username,\" \",value.id,React.createElement(\"span\",{className:\"online\",style:{float:'left',marginLeft:'-19px'}})),React.createElement(\"p\",null,\"new user for sq dashboard\")):React.createElement(\"div\",{className:\"chat_ib\"},value.count!=0?React.createElement(\"span\",{className:\"notifications\",style:{float:'right',backgroundColor:'#1890ff'}},value.count):null,React.createElement(\"h5\",{value:value.id},value.username,\" \",value.id,React.createElement(\"span\",{className:\"offline\",style:{float:'left',marginLeft:'-19px',backgroundColor:'#faad14'}})),React.createElement(\"p\",null,\"new user for sq dashboard\")))));}))),React.createElement(\"div\",{className:\"mesgs\"},React.createElement(\"div\",{className:\"alert alert-success  select_user\"},React.createElement(\"strong\",{style:{marginLeft:\"19px\"}},this.state.select_username),React.createElement(\"img\",{src:\"https://ptetutorials.com/images/user-profile.png\",alt:\"sunil\",className:\"hear_user\"})),this.state.massage_box==true?React.createElement(\"div\",{className:\"msg_history\"},React.createElement(\"div\",{className:\"incoming_msg\"},this.state.msg_list.map(function(value,index){return React.createElement(\"div\",{className:\"received_msg\"},_this5.state.sel_u_id==value.send_Id?React.createElement(\"div\",{className:\"received_withd_msg\"},React.createElement(\"p\",{key:index},value.message,\" \"),React.createElement(\"span\",{className:\"time_date\"},value.sender_name,\" \",value.time)):null,_this5.state.sel_u_id==value.received_Id?React.createElement(\"div\",{className:\"outgoing_msg\"},React.createElement(\"div\",{className:\"sent_msg\"},React.createElement(\"p\",{key:index},value.message,\" \"),React.createElement(\"span\",{className:\"time_date\"},value.sender_name,\"   \",value.time))):null);}))):React.createElement(\"div\",{style:{marginTop:'132px',color:'#bfd0d6'}},React.createElement(ChatIcon,{style:{fontSize:'100px',marginLeft:'144px',color:'#bfd0d6'}}),React.createElement(\"h2\",{className:\"msg_history\",style:{color:'#bfd0d6',textAlign:'center'}},\" Welcome to chat \")),React.createElement(\"div\",{className:\"type_msg\"},React.createElement(\"div\",{className:\"input_msg_write\"},React.createElement(\"input\",{type:\"text\",ref:\"msg\",className:\"write_msg\",placeholder:\"Type a message\",value:this.state.message,onKeyPress:this.handleKeyPress.bind(this),onChange:this.handleChange.bind(this)}),React.createElement(\"button\",{className:\"msg_send_btn\",type:\"button\",onClick:this.handleSendMassage},React.createElement(SendOutlinedIcon,null)))))));}}]);return ChartRoom;}(Component);export default ChartRoom;","map":{"version":3,"sources":["/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/src/Management/Layout/chart_room.js"],"names":["React","Component","useState","useEffect","Layout","Menu","Dropdown","Icon","Button","Avatar","Drawer","Input","AppRouter","NotificationTab","ReactApexChart","$","Popper","isAbsolute","styles","axios","Host","firebase","SendOutlinedIcon","ChatIcon","AccessAlarm","ThreeDRotation","FirebaseConfig","stylesIcons","largeIcon","width","height","ChartRoom","props","selectUser","username","id","setState","msg_list","massage_box","select_username","received_id","sel_u_id","allMassageList","readMessage","handleSendMassage","e","massage","refs","msg","value","today","Date","time","getHours","getMinutes","getSeconds","date","getFullYear","getMonth","getDate","state","message","newItem","user_Id","user_id","sender_name","user_Name","receive_name","send_Id","received_Id","msg_Status","is_read","count","timestamp","database","ServerValue","TIMESTAMP","messageSend","push","myFunction","input","filter","ul","p","a","i","txtValue","li","li1","document","getElementById","toUpperCase","getElementsByTagName","length","textContent","innerText","indexOf","style","display","online","user_list","userName","send_msg_list","received_list","send_id","text","user_text","user_status","user_Email","massage_List","x","u","ref","child","allUserStatus","profile_data","JSON","parse","sessionStorage","getItem","loadAllUserList","massageCount","orderByChild","equalTo","on","val","rid","Object","keys","rsm_list","values","y","cnt","index","map","console","log","msg_count","u_l","post","loginURL","email","promise","status","users_list","data","users","event","key","target","snapshot","forEach","record","update","s_id","m_list","re_data","userStatus","u_list","ulist","j","float","backgroundColor","marginLeft","marginTop","color","fontSize","textAlign","handleKeyPress","bind","handleChange"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect }  from \"react\";\nimport { Layout, Menu, Dropdown, Icon, Button, Avatar, Drawer, Input } from \"antd\";\nimport AppRouter from \"../../router\";\nimport { NotificationTab } from \"../components/Header\";\nimport \"./PageLayout.scss\";\nimport ReactApexChart from 'react-apexcharts'\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport $ from 'jquery';\nimport Popper from 'popper.js';\nimport 'bootstrap/dist/js/bootstrap.bundle.min';\nimport { isAbsolute } from \"path\";\nimport * as styles  from \"./chat.scss\"\nimport axios from \"axios\";\nimport { Host } from  \"../../Host\";\nimport firebase from 'firebase';\nimport SendOutlinedIcon from '@material-ui/icons/SendOutlined';\nimport ChatIcon from '@material-ui/icons/Chat';\n\nimport { AccessAlarm, ThreeDRotation } from '@material-ui/icons';\nimport { FirebaseConfig } from  \"../../FirebaseConfig\";\n\n\nconst stylesIcons = {\n\n  largeIcon: {\n    width: 500,\n    height: 60,\n  },\n\n};\n\n\n\nclass ChartRoom extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n        online:false,\n        massage_box:false,\n        select_username:'',\n        user_list:[],\n        userName:'Vamsi',\n        user_id:'',\n        sel_u_id:'',\n        send_msg_list:[],\n        received_list:[],\n        send_id:'',\n        received_id:'',\n        text:'sqd_massages',\n        user_text:'users',\n        user_status:[],\n        msg:'',\n        message:'',\n        user_Name:'',\n        user_Email:'',\n        massage_List:'',\n        msg_list:[{'massage':'hi'}],\n        x:1,\n        u:[],\n    }\n    this.messageSend = firebase.database().ref().child('messages/' + this.state.text);\n    this.allMassageList();\n\n    this.allUserStatus();\n  }\n\ncomponentWillMount() {\n    var profile_data = JSON.parse(sessionStorage.getItem(\"session_data\"));\n    this.setState({user_Name:profile_data['username']});\n    this.setState({user_Email:profile_data['email']});\n    this.loadAllUserList()\n    this.massageCount()\n    this.allMassageList(1);\n    this.setState({user_id:profile_data['user_id']});\n}\n\n\nasync massageCount(){\n       this.msg = firebase.database().ref().child('messages/' + this.state.text)\n       .orderByChild(\"is_read\").equalTo(false).on('value', message => {\n       if ( message.val() != null){\n//            console.log('vei',Object.values(message.val()))\n            var count = {};\n            var rid = [];\n//            console.log('values',Object.values(this.state.user_list))\n            for(var x=0; x<Object.keys(this.state.user_list).length; x++){\n                rid.push(this.state.user_list[x]['id'])\n            }\n//                console.log(rid)\n            var rsm_list = Object.values(message.val());\n            if(rsm_list!=null){\n                for(var y in rid){\n                    var cnt = 0;\n\n              for (var i = 0; i < Object.keys(rsm_list).length; i++) {\n                if(rsm_list[i]['received_Id'] == this.state.user_id && rsm_list[i]['send_Id'] == rid[y]){\n                      cnt+=1\n                } }\n                var index = this.state.user_list.map(function (i) { return i.id; }).indexOf(rid[y]);\n                this.state.user_list[index]['count']=cnt\n//                this.setState({msg_count:count});\n     //         console.log(this.state.user_list)\n              }\n\n             console.log(this.state.user_list)\n              this.setState({u:this.state.user_list})\n//             this.setState({msg_list:this.state.user_list})\n              }\n            else{\n                this.setState({ msg_count:[]});\n            }\n       } else{\n           var i;\n           var u_l =  this.state.user_list;\n           for (var i = 0; i < Object.keys(u_l).length; i++){\n             u_l[i]['count']= 0;\n           this.setState({u:u_l})\n          }\n        }\n\n       });\n\n\n}\n\nasync loadAllUserList()\n  {\n    this.setState({user_list:[]});\n    var profile_data = JSON.parse(sessionStorage.getItem(\"session_data\"));\n    const promise = await axios.post(Host.loginURL +\"/chat_user_api\", {username:profile_data['username'],\n                                                                      user_id:profile_data['user_id'],\n                                                                      email:profile_data['email']});\n    const status = promise.status;\n    if(status===200)\n    {\n      const users_list= promise.data.users;\n      this.setState({user_list:users_list});\n    }\n  }\n\n\nselectUser = (username, id) => {\n    this.setState({msg_list:[]});\n    this.setState({massage_box:true});\n    this.setState({select_username:username});\n    this.setState({received_id:id});\n    this.setState({sel_u_id:id});\n    this.allMassageList(id);\n    this.readMessage(id)\n\n\n  };\n\n\n  handleSendMassage = (e) => {\n     this.setState({msg_list:[]});\n     this.setState({massage:this.refs.msg.value})\n      var today = new Date();\n      var time = today.getHours() + ':' + today.getMinutes() + ':' + today.getSeconds();\n      var date = today.getFullYear() + '-' + (today.getMonth() + 1) + '-' + today.getDate();\n      if(this.state.message != ''){\n        var newItem = {\n        user_Id:this.state.user_id,\n        sender_name:this.state.user_Name,\n        receive_name:this.state.select_username,\n        send_Id:this.state.user_id,\n        received_Id:this.state.received_id,\n        message:this.state.message,\n        time:time,\n        msg_Status:false,\n        is_read:false,\n        count:0,\n        timestamp : firebase.database.ServerValue.TIMESTAMP\n      }\n      this.messageSend.push(newItem);\n      this.setState({ message: '' });\n\n      }\n\n  }\n\n  handleKeyPress(event) {\n    if (event.key !== 'Enter') return;\n    this.handleSendMassage();\n  }\n\n  handleChange(event) {\n    this.setState({message: event.target.value});\n  }\n\n\nasync readMessage(id) {\n  firebase.database().ref().child('messages/' + 'sqd_massages').orderByChild(\"received_Id\").equalTo(this.state.user_id)\n      .on(\"value\", function(snapshot) {\n          if (snapshot.val() != null){\n              if(Object.values(snapshot.val()).length >= 1){\n                snapshot.forEach(function(data) {\n                var record = data.val();\n                if( id == record['send_Id']){\n                    var key = data.key;\n                    console.log(key)\n                     firebase.database().ref().child('messages/' + 'sqd_massages/'+ key).update({ is_read: \"true\"});\n                      }\n\n                });\n              }\n          }\n         else{\n\n         }\n    });\n}\n\n\n\n\n\nasync allMassageList(id){\n       const s_id = id;\n       this.msg = firebase.database().ref().child('messages/' + this.state.text).on('value', message => {\n            if ( message.val() != null){\n              var i;\n              var m_list = []\n              var rsm_list = Object.values(message.val());\n              for (i = 0; i < Object.keys(rsm_list).length; i++) {\n                if((this.state.user_id == rsm_list[i]['received_Id']) || (this.state.user_id == rsm_list[i]['send_Id'])){\n                      var re_data = rsm_list[i]\n                      m_list.push(re_data)\n                }\n               this.setState({msg_list:m_list});\n\n              }\n            }\n            else{\n                this.setState({ msg_list:[]});\n            }\n\n       });\n\n}\n\n\nasync allUserStatus(){\n\n       this.msg = this.userStatus = firebase.database().ref().child('messages/' + this.state.user_text)\n       .on('value', message => {\n            if ( message.val() != null){\n              var u_list = Object.values(message.val());\n              this.setState({user_status:u_list})\n\n              var i;\n              var ulist = this.state.user_list;\n                for (i = 0; i < Object.keys(ulist).length; i++) {\n                 var j;\n                 for (j = 0; j< Object.keys(u_list).length; j++) {\n                     if(ulist[i]['id'] == u_list[j]['user_Id']){\n                        if(u_list[i]['user_status'] == 'online'){\n                           ulist[i]['user_status'] = 'online';\n                        }\n                        else{\n                          ulist[i]['user_status'] = 'offline';\n                        }\n\n                     }\n                     else{\n                     }\n                 }\n              }\n           this.setState({u:ulist})\n\n\n            }\n            else{\n                this.setState({ user_status:[]});\n            }\n       });\n}\n\n\n myFunction = (e) =>{\n    var input, filter, ul, p, a, i, txtValue, li, li1;\n    input = document.getElementById(\"Input\");\n    filter = input.value.toUpperCase();\n    ul = document.getElementById(\"my_search\");\n    li = ul.getElementsByTagName(\"div\");\n    for (i = 0; i < li.length; i++) {\n        a = li[i].getElementsByTagName(\"h5\")[0];\n        txtValue = a.textContent || a.innerText;\n        if (txtValue.toUpperCase().indexOf(filter) > -1) {\n            li[i].style.display = \"\";\n        } else {\n            li[i].style.display = \"none\";\n        }\n    }\n}\n\n\n\n\n  render() {\n\n\n    return (\n    <div className=\"messaging\">\n      <div className=\"inbox_msg\">\n        <div className=\"inbox_people\">\n              <div className=\"headind_srch\">\n                    <div className=\"recent_heading\">\n                      <h4><Icon type=\"group\" />Users</h4>\n                    </div>\n                    <div className=\"srch_bar\">\n                      <div className=\"stylish-input-group\">\n                        <input type=\"text\" className=\"search-bar\"  placeholder=\"Search\" id = \"Input\"\n                         onChange={this.myFunction}/ >\n                        </div>\n                    </div>\n              </div>\n\n\n          <div id=\"my_search\"  className=\"inbox_chat scroll\">\n              {this.state.u.map((value, index) =>\n\n                <div  className=\"chat_list active_chat\" id=\"myUL\"  key={index} onClick={()=>this.selectUser(value.username, value.id)}>\n                  <div className=\"chat_people\" value={this.state.select_username}>\n                        <img src=\"https://ptetutorials.com/images/user-profile.png\" alt=\"sunil\" className=\"chat_img\" />\n\n                         <div>\n                             {value.user_status == 'online'?\n                                 <div className=\"chat_ib\">\n                                  {value.count!=0 ?<span className=\"notifications\" style={{float:'right',backgroundColor:'#1890ff'}}>\n                                    {value.count}</span>:null}\n                                  <h5 value={value.id} >{value.username} {value.id}\n                                   <span className=\"online\" style={{float:'left', marginLeft: '-19px'}}></span>\n                                   </h5>\n                                  <p>new user for sq dashboard</p>\n                                </div>:\n\n                                <div className=\"chat_ib\">\n                                   {value.count!=0 ?<span className=\"notifications\" style={{float:'right',backgroundColor:'#1890ff'}}>\n                                    {value.count}</span>:null}\n                                  <h5 value={value.id}>{value.username} {value.id}\n                                   <span className=\"offline\" style={{float:'left', marginLeft:'-19px',backgroundColor:'#faad14'}}></span>\n                                   </h5>\n\n                                  <p>new user for sq dashboard</p>\n                                </div>\n                             }\n                       </div>\n\n                  </div>\n\n                </div>\n                )}\n            </div>\n\t  </div>\n\n\n\n        <div className=\"mesgs\">\n        <div className=\"alert alert-success  select_user\">\n          <strong style={{marginLeft:\"19px\"}}>{this.state.select_username}</strong >\n         <img src=\"https://ptetutorials.com/images/user-profile.png\" alt=\"sunil\" className=\"hear_user\" />\n          </div>\n\n        {this.state.massage_box == true?\n          <div className=\"msg_history\">\n                  <div className=\"incoming_msg\">\n                         { this.state.msg_list.map((value, index) =>\n                              <div className=\"received_msg\">\n                              {this.state.sel_u_id == value.send_Id?\n                                <div className=\"received_withd_msg\">\n                                    <p key={index}>{value.message} </p>\n                                  <span className=\"time_date\">{value.sender_name} {value.time}</span>\n                                  </div>:null\n                                  }\n                                  {this.state.sel_u_id == value.received_Id?\n                                  <div className=\"outgoing_msg\">\n                                        <div className=\"sent_msg\">\n                                        <p key={index}>{value.message} </p>\n                                        <span className=\"time_date\">{value.sender_name}   {value.time}</span>\n                                        </div>\n                                  </div>:null\n                               }\n                              </div>\n                          )}\n                        </div>\n\n            </div>: <div style={{marginTop:'132px', color:'#bfd0d6'}}>\n                       <ChatIcon style={{fontSize:'100px', marginLeft:'144px',color:'#bfd0d6'}}/>\n                       <h2 className=\"msg_history\" style={{color:'#bfd0d6', textAlign:'center'}}> Welcome to chat </h2>\n                     </div>\n          }\n\n          <div className=\"type_msg\">\n            <div className=\"input_msg_write\">\n              <input type=\"text\"  ref='msg' className=\"write_msg\" placeholder=\"Type a message\"\n                                              value={this.state.message}\n                                              onKeyPress={this.handleKeyPress.bind(this)}\n                                              onChange={this.handleChange.bind(this)}/>\n                  <button className=\"msg_send_btn\" type=\"button\" onClick={this.handleSendMassage}>\n                   <SendOutlinedIcon />\n                   </button>\n            </div>\n          </div>\n\n        </div>\n  </div>\n</div>\n\n    );\n  }\n}\n\nexport default ChartRoom;\n"]},"metadata":{},"sourceType":"module"}