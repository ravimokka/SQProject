{"ast":null,"code":"/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar axisIds = require('../../plots/cartesian/axis_ids');\n\nvar scatterSubTypes = require('../../traces/scatter/subtypes');\n\nvar Registry = require('../../registry');\n\nvar createModeBar = require('./modebar');\n\nvar modeBarButtons = require('./buttons');\n/**\n * ModeBar wrapper around 'create' and 'update',\n * chooses buttons to pass to ModeBar constructor based on\n * plot type and plot config.\n *\n * @param {object} gd main plot object\n *\n */\n\n\nmodule.exports = function manageModeBar(gd) {\n  var fullLayout = gd._fullLayout;\n  var context = gd._context;\n  var modeBar = fullLayout._modeBar;\n\n  if (!context.displayModeBar && !context.watermark) {\n    if (modeBar) {\n      modeBar.destroy();\n      delete fullLayout._modeBar;\n    }\n\n    return;\n  }\n\n  if (!Array.isArray(context.modeBarButtonsToRemove)) {\n    throw new Error(['*modeBarButtonsToRemove* configuration options', 'must be an array.'].join(' '));\n  }\n\n  if (!Array.isArray(context.modeBarButtonsToAdd)) {\n    throw new Error(['*modeBarButtonsToAdd* configuration options', 'must be an array.'].join(' '));\n  }\n\n  var customButtons = context.modeBarButtons;\n  var buttonGroups;\n\n  if (Array.isArray(customButtons) && customButtons.length) {\n    buttonGroups = fillCustomButton(customButtons);\n  } else if (!context.displayModeBar && context.watermark) {\n    buttonGroups = [];\n  } else {\n    buttonGroups = getButtonGroups(gd);\n  }\n\n  if (modeBar) modeBar.update(gd, buttonGroups);else fullLayout._modeBar = createModeBar(gd, buttonGroups);\n}; // logic behind which buttons are displayed by default\n\n\nfunction getButtonGroups(gd) {\n  var fullLayout = gd._fullLayout;\n  var fullData = gd._fullData;\n  var context = gd._context;\n  var buttonsToRemove = context.modeBarButtonsToRemove;\n  var buttonsToAdd = context.modeBarButtonsToAdd;\n\n  var hasCartesian = fullLayout._has('cartesian');\n\n  var hasGL3D = fullLayout._has('gl3d');\n\n  var hasGeo = fullLayout._has('geo');\n\n  var hasPie = fullLayout._has('pie');\n\n  var hasFunnelarea = fullLayout._has('funnelarea');\n\n  var hasGL2D = fullLayout._has('gl2d');\n\n  var hasTernary = fullLayout._has('ternary');\n\n  var hasMapbox = fullLayout._has('mapbox');\n\n  var hasPolar = fullLayout._has('polar');\n\n  var hasSankey = fullLayout._has('sankey');\n\n  var allAxesFixed = areAllAxesFixed(fullLayout);\n  var groups = [];\n\n  function addGroup(newGroup) {\n    if (!newGroup.length) return;\n    var out = [];\n\n    for (var i = 0; i < newGroup.length; i++) {\n      var button = newGroup[i];\n      if (buttonsToRemove.indexOf(button) !== -1) continue;\n      out.push(modeBarButtons[button]);\n    }\n\n    groups.push(out);\n  } // buttons common to all plot types\n\n\n  var commonGroup = ['toImage'];\n  if (context.showEditInChartStudio) commonGroup.push('editInChartStudio');else if (context.showSendToCloud) commonGroup.push('sendDataToCloud');\n  addGroup(commonGroup);\n  var zoomGroup = [];\n  var hoverGroup = [];\n  var resetGroup = [];\n  var dragModeGroup = [];\n\n  if ((hasCartesian || hasGL2D || hasPie || hasFunnelarea || hasTernary) + hasGeo + hasGL3D + hasMapbox + hasPolar > 1) {\n    // graphs with more than one plot types get 'union buttons'\n    // which reset the view or toggle hover labels across all subplots.\n    hoverGroup = ['toggleHover'];\n    resetGroup = ['resetViews'];\n  } else if (hasGeo) {\n    zoomGroup = ['zoomInGeo', 'zoomOutGeo'];\n    hoverGroup = ['hoverClosestGeo'];\n    resetGroup = ['resetGeo'];\n  } else if (hasGL3D) {\n    hoverGroup = ['hoverClosest3d'];\n    resetGroup = ['resetCameraDefault3d', 'resetCameraLastSave3d'];\n  } else if (hasMapbox) {\n    hoverGroup = ['toggleHover'];\n    resetGroup = ['resetViewMapbox'];\n  } else if (hasGL2D) {\n    hoverGroup = ['hoverClosestGl2d'];\n  } else if (hasPie) {\n    hoverGroup = ['hoverClosestPie'];\n  } else if (hasSankey) {\n    hoverGroup = ['hoverClosestCartesian', 'hoverCompareCartesian'];\n    resetGroup = ['resetViewSankey'];\n  } else {\n    // hasPolar, hasTernary\n    // always show at least one hover icon.\n    hoverGroup = ['toggleHover'];\n  } // if we have cartesian, allow switching between closest and compare\n  // regardless of what other types are on the plot, since they'll all\n  // just treat any truthy hovermode as 'closest'\n\n\n  if (hasCartesian) {\n    hoverGroup = ['toggleSpikelines', 'hoverClosestCartesian', 'hoverCompareCartesian'];\n  }\n\n  if (hasNoHover(fullData)) {\n    hoverGroup = [];\n  }\n\n  if ((hasCartesian || hasGL2D) && !allAxesFixed) {\n    zoomGroup = ['zoomIn2d', 'zoomOut2d', 'autoScale2d'];\n    if (resetGroup[0] !== 'resetViews') resetGroup = ['resetScale2d'];\n  }\n\n  if (hasGL3D) {\n    dragModeGroup = ['zoom3d', 'pan3d', 'orbitRotation', 'tableRotation'];\n  } else if ((hasCartesian || hasGL2D) && !allAxesFixed || hasTernary) {\n    dragModeGroup = ['zoom2d', 'pan2d'];\n  } else if (hasMapbox || hasGeo) {\n    dragModeGroup = ['pan2d'];\n  } else if (hasPolar) {\n    dragModeGroup = ['zoom2d'];\n  }\n\n  if (isSelectable(fullData)) {\n    dragModeGroup.push('select2d', 'lasso2d');\n  }\n\n  addGroup(dragModeGroup);\n  addGroup(zoomGroup.concat(resetGroup));\n  addGroup(hoverGroup);\n  return appendButtonsToGroups(groups, buttonsToAdd);\n}\n\nfunction areAllAxesFixed(fullLayout) {\n  var axList = axisIds.list({\n    _fullLayout: fullLayout\n  }, null, true);\n\n  for (var i = 0; i < axList.length; i++) {\n    if (!axList[i].fixedrange) {\n      return false;\n    }\n  }\n\n  return true;\n} // look for traces that support selection\n// to be updated as we add more selectPoints handlers\n\n\nfunction isSelectable(fullData) {\n  var selectable = false;\n\n  for (var i = 0; i < fullData.length; i++) {\n    if (selectable) break;\n    var trace = fullData[i];\n    if (!trace._module || !trace._module.selectPoints) continue;\n\n    if (Registry.traceIs(trace, 'scatter-like')) {\n      if (scatterSubTypes.hasMarkers(trace) || scatterSubTypes.hasText(trace)) {\n        selectable = true;\n      }\n    } else if (Registry.traceIs(trace, 'box-violin')) {\n      if (trace.boxpoints === 'all' || trace.points === 'all') {\n        selectable = true;\n      }\n    } else {\n      // assume that in general if the trace module has selectPoints,\n      // then it's selectable. Scatter is an exception to this because it must\n      // have markers or text, not just be a scatter type.\n      selectable = true;\n    }\n  }\n\n  return selectable;\n} // check whether all trace are 'noHover'\n\n\nfunction hasNoHover(fullData) {\n  for (var i = 0; i < fullData.length; i++) {\n    if (!Registry.traceIs(fullData[i], 'noHover')) return false;\n  }\n\n  return true;\n}\n\nfunction appendButtonsToGroups(groups, buttons) {\n  if (buttons.length) {\n    if (Array.isArray(buttons[0])) {\n      for (var i = 0; i < buttons.length; i++) {\n        groups.push(buttons[i]);\n      }\n    } else groups.push(buttons);\n  }\n\n  return groups;\n} // fill in custom buttons referring to default mode bar buttons\n\n\nfunction fillCustomButton(customButtons) {\n  for (var i = 0; i < customButtons.length; i++) {\n    var buttonGroup = customButtons[i];\n\n    for (var j = 0; j < buttonGroup.length; j++) {\n      var button = buttonGroup[j];\n\n      if (typeof button === 'string') {\n        if (modeBarButtons[button] !== undefined) {\n          customButtons[i][j] = modeBarButtons[button];\n        } else {\n          throw new Error(['*modeBarButtons* configuration options', 'invalid button name'].join(' '));\n        }\n      }\n    }\n  }\n\n  return customButtons;\n}","map":{"version":3,"sources":["/home/user/Desktop/milonux-sq-dashboard-59aefe7abad7/node_modules/plotly.js/src/components/modebar/manage.js"],"names":["axisIds","require","scatterSubTypes","Registry","createModeBar","modeBarButtons","module","exports","manageModeBar","gd","fullLayout","_fullLayout","context","_context","modeBar","_modeBar","displayModeBar","watermark","destroy","Array","isArray","modeBarButtonsToRemove","Error","join","modeBarButtonsToAdd","customButtons","buttonGroups","length","fillCustomButton","getButtonGroups","update","fullData","_fullData","buttonsToRemove","buttonsToAdd","hasCartesian","_has","hasGL3D","hasGeo","hasPie","hasFunnelarea","hasGL2D","hasTernary","hasMapbox","hasPolar","hasSankey","allAxesFixed","areAllAxesFixed","groups","addGroup","newGroup","out","i","button","indexOf","push","commonGroup","showEditInChartStudio","showSendToCloud","zoomGroup","hoverGroup","resetGroup","dragModeGroup","hasNoHover","isSelectable","concat","appendButtonsToGroups","axList","list","fixedrange","selectable","trace","_module","selectPoints","traceIs","hasMarkers","hasText","boxpoints","points","buttons","buttonGroup","j","undefined"],"mappings":"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","sourcesContent":["/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n\n\n'use strict';\n\nvar axisIds = require('../../plots/cartesian/axis_ids');\nvar scatterSubTypes = require('../../traces/scatter/subtypes');\nvar Registry = require('../../registry');\n\nvar createModeBar = require('./modebar');\nvar modeBarButtons = require('./buttons');\n\n/**\n * ModeBar wrapper around 'create' and 'update',\n * chooses buttons to pass to ModeBar constructor based on\n * plot type and plot config.\n *\n * @param {object} gd main plot object\n *\n */\nmodule.exports = function manageModeBar(gd) {\n    var fullLayout = gd._fullLayout;\n    var context = gd._context;\n    var modeBar = fullLayout._modeBar;\n\n    if(!context.displayModeBar && !context.watermark) {\n        if(modeBar) {\n            modeBar.destroy();\n            delete fullLayout._modeBar;\n        }\n        return;\n    }\n\n    if(!Array.isArray(context.modeBarButtonsToRemove)) {\n        throw new Error([\n            '*modeBarButtonsToRemove* configuration options',\n            'must be an array.'\n        ].join(' '));\n    }\n\n    if(!Array.isArray(context.modeBarButtonsToAdd)) {\n        throw new Error([\n            '*modeBarButtonsToAdd* configuration options',\n            'must be an array.'\n        ].join(' '));\n    }\n\n    var customButtons = context.modeBarButtons;\n    var buttonGroups;\n\n    if(Array.isArray(customButtons) && customButtons.length) {\n        buttonGroups = fillCustomButton(customButtons);\n    } else if(!context.displayModeBar && context.watermark) {\n        buttonGroups = [];\n    } else {\n        buttonGroups = getButtonGroups(gd);\n    }\n\n    if(modeBar) modeBar.update(gd, buttonGroups);\n    else fullLayout._modeBar = createModeBar(gd, buttonGroups);\n};\n\n// logic behind which buttons are displayed by default\nfunction getButtonGroups(gd) {\n    var fullLayout = gd._fullLayout;\n    var fullData = gd._fullData;\n    var context = gd._context;\n    var buttonsToRemove = context.modeBarButtonsToRemove;\n    var buttonsToAdd = context.modeBarButtonsToAdd;\n\n    var hasCartesian = fullLayout._has('cartesian');\n    var hasGL3D = fullLayout._has('gl3d');\n    var hasGeo = fullLayout._has('geo');\n    var hasPie = fullLayout._has('pie');\n    var hasFunnelarea = fullLayout._has('funnelarea');\n    var hasGL2D = fullLayout._has('gl2d');\n    var hasTernary = fullLayout._has('ternary');\n    var hasMapbox = fullLayout._has('mapbox');\n    var hasPolar = fullLayout._has('polar');\n    var hasSankey = fullLayout._has('sankey');\n    var allAxesFixed = areAllAxesFixed(fullLayout);\n\n    var groups = [];\n\n    function addGroup(newGroup) {\n        if(!newGroup.length) return;\n\n        var out = [];\n\n        for(var i = 0; i < newGroup.length; i++) {\n            var button = newGroup[i];\n            if(buttonsToRemove.indexOf(button) !== -1) continue;\n            out.push(modeBarButtons[button]);\n        }\n\n        groups.push(out);\n    }\n\n    // buttons common to all plot types\n    var commonGroup = ['toImage'];\n    if(context.showEditInChartStudio) commonGroup.push('editInChartStudio');\n    else if(context.showSendToCloud) commonGroup.push('sendDataToCloud');\n    addGroup(commonGroup);\n\n    var zoomGroup = [];\n    var hoverGroup = [];\n    var resetGroup = [];\n    var dragModeGroup = [];\n\n    if((hasCartesian || hasGL2D || hasPie || hasFunnelarea || hasTernary) + hasGeo + hasGL3D + hasMapbox + hasPolar > 1) {\n        // graphs with more than one plot types get 'union buttons'\n        // which reset the view or toggle hover labels across all subplots.\n        hoverGroup = ['toggleHover'];\n        resetGroup = ['resetViews'];\n    } else if(hasGeo) {\n        zoomGroup = ['zoomInGeo', 'zoomOutGeo'];\n        hoverGroup = ['hoverClosestGeo'];\n        resetGroup = ['resetGeo'];\n    } else if(hasGL3D) {\n        hoverGroup = ['hoverClosest3d'];\n        resetGroup = ['resetCameraDefault3d', 'resetCameraLastSave3d'];\n    } else if(hasMapbox) {\n        hoverGroup = ['toggleHover'];\n        resetGroup = ['resetViewMapbox'];\n    } else if(hasGL2D) {\n        hoverGroup = ['hoverClosestGl2d'];\n    } else if(hasPie) {\n        hoverGroup = ['hoverClosestPie'];\n    } else if(hasSankey) {\n        hoverGroup = ['hoverClosestCartesian', 'hoverCompareCartesian'];\n        resetGroup = ['resetViewSankey'];\n    } else { // hasPolar, hasTernary\n        // always show at least one hover icon.\n        hoverGroup = ['toggleHover'];\n    }\n    // if we have cartesian, allow switching between closest and compare\n    // regardless of what other types are on the plot, since they'll all\n    // just treat any truthy hovermode as 'closest'\n    if(hasCartesian) {\n        hoverGroup = ['toggleSpikelines', 'hoverClosestCartesian', 'hoverCompareCartesian'];\n    }\n    if(hasNoHover(fullData)) {\n        hoverGroup = [];\n    }\n\n    if((hasCartesian || hasGL2D) && !allAxesFixed) {\n        zoomGroup = ['zoomIn2d', 'zoomOut2d', 'autoScale2d'];\n        if(resetGroup[0] !== 'resetViews') resetGroup = ['resetScale2d'];\n    }\n\n    if(hasGL3D) {\n        dragModeGroup = ['zoom3d', 'pan3d', 'orbitRotation', 'tableRotation'];\n    } else if(((hasCartesian || hasGL2D) && !allAxesFixed) || hasTernary) {\n        dragModeGroup = ['zoom2d', 'pan2d'];\n    } else if(hasMapbox || hasGeo) {\n        dragModeGroup = ['pan2d'];\n    } else if(hasPolar) {\n        dragModeGroup = ['zoom2d'];\n    }\n    if(isSelectable(fullData)) {\n        dragModeGroup.push('select2d', 'lasso2d');\n    }\n\n    addGroup(dragModeGroup);\n    addGroup(zoomGroup.concat(resetGroup));\n    addGroup(hoverGroup);\n\n    return appendButtonsToGroups(groups, buttonsToAdd);\n}\n\nfunction areAllAxesFixed(fullLayout) {\n    var axList = axisIds.list({_fullLayout: fullLayout}, null, true);\n\n    for(var i = 0; i < axList.length; i++) {\n        if(!axList[i].fixedrange) {\n            return false;\n        }\n    }\n\n    return true;\n}\n\n// look for traces that support selection\n// to be updated as we add more selectPoints handlers\nfunction isSelectable(fullData) {\n    var selectable = false;\n\n    for(var i = 0; i < fullData.length; i++) {\n        if(selectable) break;\n\n        var trace = fullData[i];\n\n        if(!trace._module || !trace._module.selectPoints) continue;\n\n        if(Registry.traceIs(trace, 'scatter-like')) {\n            if(scatterSubTypes.hasMarkers(trace) || scatterSubTypes.hasText(trace)) {\n                selectable = true;\n            }\n        } else if(Registry.traceIs(trace, 'box-violin')) {\n            if(trace.boxpoints === 'all' || trace.points === 'all') {\n                selectable = true;\n            }\n        } else {\n            // assume that in general if the trace module has selectPoints,\n            // then it's selectable. Scatter is an exception to this because it must\n            // have markers or text, not just be a scatter type.\n\n            selectable = true;\n        }\n    }\n\n    return selectable;\n}\n\n// check whether all trace are 'noHover'\nfunction hasNoHover(fullData) {\n    for(var i = 0; i < fullData.length; i++) {\n        if(!Registry.traceIs(fullData[i], 'noHover')) return false;\n    }\n    return true;\n}\n\nfunction appendButtonsToGroups(groups, buttons) {\n    if(buttons.length) {\n        if(Array.isArray(buttons[0])) {\n            for(var i = 0; i < buttons.length; i++) {\n                groups.push(buttons[i]);\n            }\n        } else groups.push(buttons);\n    }\n\n    return groups;\n}\n\n// fill in custom buttons referring to default mode bar buttons\nfunction fillCustomButton(customButtons) {\n    for(var i = 0; i < customButtons.length; i++) {\n        var buttonGroup = customButtons[i];\n\n        for(var j = 0; j < buttonGroup.length; j++) {\n            var button = buttonGroup[j];\n\n            if(typeof button === 'string') {\n                if(modeBarButtons[button] !== undefined) {\n                    customButtons[i][j] = modeBarButtons[button];\n                } else {\n                    throw new Error([\n                        '*modeBarButtons* configuration options',\n                        'invalid button name'\n                    ].join(' '));\n                }\n            }\n        }\n    }\n\n    return customButtons;\n}\n"]},"metadata":{},"sourceType":"script"}