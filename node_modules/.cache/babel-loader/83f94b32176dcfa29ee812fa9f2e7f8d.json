{"ast":null,"code":"/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar isNumeric = require('fast-isnumeric');\n\nvar Lib = require('../../lib');\n\nmodule.exports = function handlePositionDefaults(containerIn, containerOut, coerce, options) {\n  var counterAxes = options.counterAxes || [];\n  var overlayableAxes = options.overlayableAxes || [];\n  var letter = options.letter;\n  var grid = options.grid;\n  var dfltAnchor, dfltDomain, dfltSide, dfltPosition;\n\n  if (grid) {\n    dfltDomain = grid._domains[letter][grid._axisMap[containerOut._id]];\n    dfltAnchor = grid._anchors[containerOut._id];\n\n    if (dfltDomain) {\n      dfltSide = grid[letter + 'side'].split(' ')[0];\n      dfltPosition = grid.domain[letter][dfltSide === 'right' || dfltSide === 'top' ? 1 : 0];\n    }\n  } // Even if there's a grid, this axis may not be in it - fall back on non-grid defaults\n\n\n  dfltDomain = dfltDomain || [0, 1];\n  dfltAnchor = dfltAnchor || (isNumeric(containerIn.position) ? 'free' : counterAxes[0] || 'free');\n  dfltSide = dfltSide || (letter === 'x' ? 'bottom' : 'left');\n  dfltPosition = dfltPosition || 0;\n  var anchor = Lib.coerce(containerIn, containerOut, {\n    anchor: {\n      valType: 'enumerated',\n      values: ['free'].concat(counterAxes),\n      dflt: dfltAnchor\n    }\n  }, 'anchor');\n  if (anchor === 'free') coerce('position', dfltPosition);\n  Lib.coerce(containerIn, containerOut, {\n    side: {\n      valType: 'enumerated',\n      values: letter === 'x' ? ['bottom', 'top'] : ['left', 'right'],\n      dflt: dfltSide\n    }\n  }, 'side');\n  var overlaying = false;\n\n  if (overlayableAxes.length) {\n    overlaying = Lib.coerce(containerIn, containerOut, {\n      overlaying: {\n        valType: 'enumerated',\n        values: [false].concat(overlayableAxes),\n        dflt: false\n      }\n    }, 'overlaying');\n  }\n\n  if (!overlaying) {\n    // TODO: right now I'm copying this domain over to overlaying axes\n    // in ax.setscale()... but this means we still need (imperfect) logic\n    // in the axes popover to hide domain for the overlaying axis.\n    // perhaps I should make a private version _domain that all axes get???\n    var domain = coerce('domain', dfltDomain); // according to https://www.npmjs.com/package/canvas-size\n    // the minimum value of max canvas width across browsers and devices is 4096\n    // which applied in the calculation below:\n\n    if (domain[0] > domain[1] - 1 / 4096) containerOut.domain = dfltDomain;\n    Lib.noneOrAll(containerIn.domain, containerOut.domain, dfltDomain);\n  }\n\n  coerce('layer');\n  return containerOut;\n};","map":null,"metadata":{},"sourceType":"script"}