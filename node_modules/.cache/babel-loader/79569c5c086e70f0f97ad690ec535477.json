{"ast":null,"code":"/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Color = require('../../components/color');\n\nvar hasColorscale = require('../../components/colorscale/helpers').hasColorscale;\n\nvar colorscaleDefaults = require('../../components/colorscale/defaults');\n\nvar subTypes = require('./subtypes');\n/*\n * opts: object of flags to control features not all marker users support\n *   noLine: caller does not support marker lines\n *   gradient: caller supports gradients\n *   noSelect: caller does not support selected/unselected attribute containers\n */\n\n\nmodule.exports = function markerDefaults(traceIn, traceOut, defaultColor, layout, coerce, opts) {\n  var isBubble = subTypes.isBubble(traceIn);\n  var lineColor = (traceIn.line || {}).color;\n  var defaultMLC;\n  opts = opts || {}; // marker.color inherit from line.color (even if line.color is an array)\n\n  if (lineColor) defaultColor = lineColor;\n  coerce('marker.symbol');\n  coerce('marker.opacity', isBubble ? 0.7 : 1);\n  coerce('marker.size');\n  coerce('marker.color', defaultColor);\n\n  if (hasColorscale(traceIn, 'marker')) {\n    colorscaleDefaults(traceIn, traceOut, layout, coerce, {\n      prefix: 'marker.',\n      cLetter: 'c'\n    });\n  }\n\n  if (!opts.noSelect) {\n    coerce('selected.marker.color');\n    coerce('unselected.marker.color');\n    coerce('selected.marker.size');\n    coerce('unselected.marker.size');\n  }\n\n  if (!opts.noLine) {\n    // if there's a line with a different color than the marker, use\n    // that line color as the default marker line color\n    // (except when it's an array)\n    // mostly this is for transparent markers to behave nicely\n    if (lineColor && !Array.isArray(lineColor) && traceOut.marker.color !== lineColor) {\n      defaultMLC = lineColor;\n    } else if (isBubble) defaultMLC = Color.background;else defaultMLC = Color.defaultLine;\n\n    coerce('marker.line.color', defaultMLC);\n\n    if (hasColorscale(traceIn, 'marker.line')) {\n      colorscaleDefaults(traceIn, traceOut, layout, coerce, {\n        prefix: 'marker.line.',\n        cLetter: 'c'\n      });\n    }\n\n    coerce('marker.line.width', isBubble ? 1 : 0);\n  }\n\n  if (isBubble) {\n    coerce('marker.sizeref');\n    coerce('marker.sizemin');\n    coerce('marker.sizemode');\n  }\n\n  if (opts.gradient) {\n    var gradientType = coerce('marker.gradient.type');\n\n    if (gradientType !== 'none') {\n      coerce('marker.gradient.color');\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"script"}