{"ast":null,"code":"/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar colorbarAttrs = require('../colorbar/attributes');\n\nvar counterRegex = require('../../lib/regex').counter;\n\nvar palettes = require('./scales.js').scales;\n\nvar paletteStr = Object.keys(palettes);\n\nfunction code(s) {\n  return '`' + s + '`';\n}\n/**\n * Make colorscale attribute declarations for\n *\n * - colorscale,\n * - (c|z)auto, (c|z)min, (c|z)max,\n * - autocolorscale, reversescale,\n * - showscale (optionally)\n * - color (optionally)\n *\n * @param {string} context (dflt: '', i.e. from trace root):\n *     the container this is in ('', *marker*, *marker.line* etc)\n *\n * @param {object} opts:\n *   - cLetter {string} (dflt: 'c'):\n *     leading letter for 'min', 'max and 'auto' attribute (either 'z' or 'c')\n *\n *   - colorAttr {string} (dflt: 'z' if `cLetter: 'z'`, 'color' if `cLetter: 'c'`):\n *     (for descriptions) sets the name of the color attribute that maps to the colorscale.\n *\n *     N.B. if `colorAttr: 'color'`, we include the `color` declaration here.\n *\n *   - onlyIfNumerical {string} (dflt: false' if `cLetter: 'z'`, true if `cLetter: 'c'`):\n *     (for descriptions) set to true if colorscale attribute only\n *\n *   - colorscaleDflt {string}:\n *     overrides the colorscale dflt\n *\n *   - autoColorDflt {boolean} (dflt true):\n *     normally autocolorscale.dflt is `true`, but pass `false` to override\n *\n *   - noScale {boolean} (dflt: true if `context: 'marker.line'`, false otherwise):\n *     set to `false` to not include showscale attribute (e.g. for 'marker.line')\n *\n *   - showScaleDflt {boolean} (dflt: true if `cLetter: 'z'`, false otherwise)\n *\n *   - editTypeOverride {boolean} (dflt: ''):\n *     most of these attributes already require a recalc, but the ones that do not\n *     have editType *style* or *plot* unless you override (presumably with *calc*)\n *\n *   - anim {boolean) (dflt: undefined): is 'color' animatable?\n *\n * @return {object}\n */\n\n\nmodule.exports = function colorScaleAttrs(context, opts) {\n  context = context || '';\n  opts = opts || {};\n  var cLetter = opts.cLetter || 'c';\n  var onlyIfNumerical = 'onlyIfNumerical' in opts ? opts.onlyIfNumerical : Boolean(context);\n  var noScale = 'noScale' in opts ? opts.noScale : context === 'marker.line';\n  var showScaleDflt = 'showScaleDflt' in opts ? opts.showScaleDflt : cLetter === 'z';\n  var colorscaleDflt = typeof opts.colorscaleDflt === 'string' ? palettes[opts.colorscaleDflt] : null;\n  var editTypeOverride = opts.editTypeOverride || '';\n  var contextHead = context ? context + '.' : '';\n  var colorAttr, colorAttrFull;\n\n  if ('colorAttr' in opts) {\n    colorAttr = opts.colorAttr;\n    colorAttrFull = opts.colorAttr;\n  } else {\n    colorAttr = {\n      z: 'z',\n      c: 'color'\n    }[cLetter];\n    colorAttrFull = 'in ' + code(contextHead + colorAttr);\n  }\n\n  var effectDesc = onlyIfNumerical ? ' Has an effect only if ' + colorAttrFull + 'is set to a numerical array.' : '';\n  var auto = cLetter + 'auto';\n  var min = cLetter + 'min';\n  var max = cLetter + 'max';\n  var mid = cLetter + 'mid';\n  var autoFull = code(contextHead + auto);\n  var minFull = code(contextHead + min);\n  var maxFull = code(contextHead + max);\n  var minmaxFull = minFull + ' and ' + maxFull;\n  var autoImpliedEdits = {};\n  autoImpliedEdits[min] = autoImpliedEdits[max] = undefined;\n  var minmaxImpliedEdits = {};\n  minmaxImpliedEdits[auto] = false;\n  var attrs = {};\n\n  if (colorAttr === 'color') {\n    attrs.color = {\n      valType: 'color',\n      arrayOk: true,\n      role: 'style',\n      editType: editTypeOverride || 'style',\n      description: ['Sets the', context, 'color.', ' It accepts either a specific color', ' or an array of numbers that are mapped to the colorscale', ' relative to the max and min values of the array or relative to', ' ' + minmaxFull + ' if set.'].join('')\n    };\n\n    if (opts.anim) {\n      attrs.color.anim = true;\n    }\n  }\n\n  attrs[auto] = {\n    valType: 'boolean',\n    role: 'info',\n    dflt: true,\n    editType: 'calc',\n    impliedEdits: autoImpliedEdits,\n    description: ['Determines whether or not the color domain is computed', ' with respect to the input data (here ' + colorAttrFull + ') or the bounds set in', ' ', minmaxFull, ' ', effectDesc, ' Defaults to `false` when ', minmaxFull, ' are set by the user.'].join('')\n  };\n  attrs[min] = {\n    valType: 'number',\n    role: 'info',\n    dflt: null,\n    editType: editTypeOverride || 'plot',\n    impliedEdits: minmaxImpliedEdits,\n    description: ['Sets the lower bound of the color domain.', effectDesc, ' Value should have the same units as ', colorAttrFull, ' and if set, ', maxFull, ' must be set as well.'].join('')\n  };\n  attrs[max] = {\n    valType: 'number',\n    role: 'info',\n    dflt: null,\n    editType: editTypeOverride || 'plot',\n    impliedEdits: minmaxImpliedEdits,\n    description: ['Sets the upper bound of the color domain.', effectDesc, ' Value should have the same units as ', colorAttrFull, ' and if set, ', minFull, ' must be set as well.'].join('')\n  };\n  attrs[mid] = {\n    valType: 'number',\n    role: 'info',\n    dflt: null,\n    editType: 'calc',\n    impliedEdits: autoImpliedEdits,\n    description: ['Sets the mid-point of the color domain by scaling ', minFull, ' and/or ', maxFull, ' to be equidistant to this point.', effectDesc, ' Value should have the same units as ', colorAttrFull, '. ', 'Has no effect when ', autoFull, ' is `false`.'].join('')\n  };\n  attrs.colorscale = {\n    valType: 'colorscale',\n    role: 'style',\n    editType: 'calc',\n    dflt: colorscaleDflt,\n    impliedEdits: {\n      autocolorscale: false\n    },\n    description: ['Sets the colorscale.', effectDesc, ' The colorscale must be an array containing', ' arrays mapping a normalized value to an', ' rgb, rgba, hex, hsl, hsv, or named color string.', ' At minimum, a mapping for the lowest (0) and highest (1)', ' values are required. For example,', ' `[[0, \\'rgb(0,0,255)\\'], [1, \\'rgb(255,0,0)\\']]`.', ' To control the bounds of the colorscale in color space,', ' use', minmaxFull, '.', ' Alternatively, `colorscale` may be a palette name string', ' of the following list: ' + paletteStr + '.'].join('')\n  };\n  attrs.autocolorscale = {\n    valType: 'boolean',\n    role: 'style',\n    // gets overrode in 'heatmap' & 'surface' for backwards comp.\n    dflt: opts.autoColorDflt === false ? false : true,\n    editType: 'calc',\n    impliedEdits: {\n      colorscale: undefined\n    },\n    description: ['Determines whether the colorscale is a default palette (`autocolorscale: true`)', ' or the palette determined by ', code(contextHead + 'colorscale'), '.', effectDesc, ' In case `colorscale` is unspecified or `autocolorscale` is true, the default ', ' palette will be chosen according to whether numbers in the `color` array are', ' all positive, all negative or mixed.'].join('')\n  };\n  attrs.reversescale = {\n    valType: 'boolean',\n    role: 'style',\n    dflt: false,\n    editType: 'plot',\n    description: ['Reverses the color mapping if true.', effectDesc, ' If true, ', minFull, ' will correspond to the last color', ' in the array and ', maxFull, ' will correspond to the first color.'].join('')\n  };\n\n  if (!noScale) {\n    attrs.showscale = {\n      valType: 'boolean',\n      role: 'info',\n      dflt: showScaleDflt,\n      editType: 'calc',\n      description: ['Determines whether or not a colorbar is displayed for this trace.', effectDesc].join('')\n    };\n    attrs.colorbar = colorbarAttrs;\n  }\n\n  if (!opts.noColorAxis) {\n    attrs.coloraxis = {\n      valType: 'subplotid',\n      role: 'info',\n      regex: counterRegex('coloraxis'),\n      dflt: null,\n      editType: 'calc',\n      description: ['Sets a reference to a shared color axis.', 'References to these shared color axes are *coloraxis*, *coloraxis2*, *coloraxis3*, etc.', 'Settings for these shared color axes are set in the layout, under', '`layout.coloraxis`, `layout.coloraxis2`, etc.', 'Note that multiple color scales can be linked to the same color axis.'].join(' ')\n    };\n  }\n\n  return attrs;\n};","map":null,"metadata":{},"sourceType":"script"}