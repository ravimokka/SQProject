{"ast":null,"code":"/**\n* Copyright 2012-2019, Plotly, Inc.\n* All rights reserved.\n*\n* This source code is licensed under the MIT license found in the\n* LICENSE file in the root directory of this source tree.\n*/\n'use strict';\n\nvar Lib = require('../../lib');\n\nvar Registry = require('../../registry');\n\nmodule.exports = function calc(gd) {\n  var calcdata = gd.calcdata;\n  var fullLayout = gd._fullLayout;\n\n  function makeCoerceHoverInfo(trace) {\n    return function (val) {\n      return Lib.coerceHoverinfo({\n        hoverinfo: val\n      }, {\n        _module: trace._module\n      }, fullLayout);\n    };\n  }\n\n  for (var i = 0; i < calcdata.length; i++) {\n    var cd = calcdata[i];\n    var trace = cd[0].trace; // don't include hover calc fields for pie traces\n    // as calcdata items might be sorted by value and\n    // won't match the data array order.\n\n    if (Registry.traceIs(trace, 'pie-like')) continue;\n    var fillFn = Registry.traceIs(trace, '2dMap') ? paste : Lib.fillArray;\n    fillFn(trace.hoverinfo, cd, 'hi', makeCoerceHoverInfo(trace));\n    if (trace.hovertemplate) fillFn(trace.hovertemplate, cd, 'ht');\n    if (!trace.hoverlabel) continue;\n    fillFn(trace.hoverlabel.bgcolor, cd, 'hbg');\n    fillFn(trace.hoverlabel.bordercolor, cd, 'hbc');\n    fillFn(trace.hoverlabel.font.size, cd, 'hts');\n    fillFn(trace.hoverlabel.font.color, cd, 'htc');\n    fillFn(trace.hoverlabel.font.family, cd, 'htf');\n    fillFn(trace.hoverlabel.namelength, cd, 'hnl');\n    fillFn(trace.hoverlabel.align, cd, 'hta');\n  }\n};\n\nfunction paste(traceAttr, cd, cdAttr, fn) {\n  fn = fn || Lib.identity;\n\n  if (Array.isArray(traceAttr)) {\n    cd[0][cdAttr] = fn(traceAttr);\n  }\n}","map":null,"metadata":{},"sourceType":"script"}